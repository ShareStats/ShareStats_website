{{ $data := index site.Data site.Language.Lang }}

{{ if $data.banner.banner.enable }}
{{ with $data.banner.banner }}

{{"<!-- Welcome Slider-->" | safeHTML}}
<section class="hero-area notfullheight" style='background-image: url("{{ .bg_image_webp | absURL }}"); background-attachment: fixed;'>
	<!-- this image is for trigger this section fallback background image -->
	<img class="d-none" src="{{ .bg_image_webp | absURL }}" onerror="this.onerror=null;this.parentElement.style.backgroundImage= 'url({{ .bg_image | absURL }})'"/>

	<div class="block">
		
		<script src="/js/lunr.js"></script>

		<script>
		
		var documents = [{{- range $key, $value := (where $.Site.RegularPages "Section" "questions") -}}
			{
			"id": {{ $key }},
			"url": "{{ $value.Permalink }}",
			"title": "{{ $value.File.BaseFileName }}",
			"body": "{{ plainify $value.Content }}"
			}, {{- end -}}];
		
		var idx = lunr(function () {
			this.ref('id')
			this.field('title')
			this.field('body')
		
			documents.forEach(function (doc) {
				this.add(doc)
			}, this)
		});
		function lunr_search(term) {
			document.getElementById('lunrsearchresults').innerHTML = '<ul></ul>';
			if(term) {
				document.getElementById('lunrsearchresults').innerHTML = "<p>{{ i18n `resultsFor` }} '" + term + "'</p>" + document.getElementById('lunrsearchresults').innerHTML;
				var results = idx.search(term);
				if(results.length>0){
					for (var i = 0; i < results.length; i++) {
						var ref = results[i]['ref'];
						var url = documents[ref]['url'];
						var title = documents[ref]['title'];
						var body = documents[ref]['body'];
						var div = document.createElement("div");
						div.innerHTML = body;
						body = div.textContent || div.innerText || "";
						body = body.substring(0,160)+'...';
		
						document.querySelector('#lunrsearchresults ul').innerHTML = document.querySelector('#lunrsearchresults ul').innerHTML + "<li class='lunrsearchresult'><a href='" + url + "'><span class='title'>" + title + "</span><br /><span class='body'>"+ body +"</span><br /><span class='url'>"+ url +"</span></a></li>";
					}
				}
			}
			if(!term || results.length == 0) {
					if(term) document.querySelector('#lunrsearchresults').innerHTML = "<p>{{ i18n `noResultsFor` }} '" + term + "'.<p>";
					else document.querySelector('#lunrsearchresults').innerHTML = "<p>{{ i18n `noResults` }}<p>";
			}
			return false;
		}
		function getParameterByName(name) {
			name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
			var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
				results = regex.exec(location.search);
			return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
		}
		
		</script>
		
		<style>
			#lunrsearchresults p {margin-bottom: 3em; font-style: italic;}
			.lunrsearchresult {margin-bottom: 1.5em;}
			.lunrsearchresult .title {color: #00692D; text-decoration: underline;}
			.lunrsearchresult .url {color: silver;}
			.lunrsearchresult a {display: block; color: #505050; text-decoration: none;}
			.lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
			.lunrsearchresult a:hover .title {text-decoration: underline;}
		</style>
		
		
		<form onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
			<div>
				<label for="lunrsearch" style="display: none;">{{ i18n "search" }}</label>
				<input type="search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="" />
				<input type="submit" value="{{ i18n "search" }}" class="btn-main" />
			</div>
		</form>


		<p>{{ .content | markdownify }}</p>
	</div>
</section>
{{"<!-- /Welcome Slider-->" | safeHTML}}
{{end}}
{{end}}
